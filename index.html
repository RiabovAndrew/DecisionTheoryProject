<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles/Styles.css">
</head>

<body class="adjust-line-height">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <h1>1. Критерій оптимальності Севіджа</h1>
    <h2>1.1. Нерандомізований розв'язок.</h2>


    <h3>Алгоритм пошуку нерандомізованого розв’язку</h3>
    <ol>
        <li>Перейти від матриці втрат \(L=\{l_{ij}\}\) до матриці жалю \(S=\{s_{ij}\}\). Для цього необхідно знайти в кожному
            стовпці найменший елемент та відняти його від кожного елемента даного стовпця: \(s_{ij}=l_{ij}-\displaystyle
            \min_{i}l_{ij}\).</li>
        <li>Обчислити \(S(\alpha_i)=\displaystyle \max_{j}s_{ij}\), тобто для кожного рядку в матриці жалю знайти
            найбільший елемент.</li>
        <li>Обрати як розв’язок таку стратегію \(\alpha_i\), якій відповідає найменше \(S(\alpha_i)\).</li>
    </ol>


    <b>Приклад 1.1</b><br>
    Матриця втрат має вигляд
    $$L=\begin{pmatrix}0&4\\5&1\\6&3\\3&2\end{pmatrix}.$$
    Перейдемо до матриці жалю. Найменший елемент у першому стовпці – 0, а в другому – 1.
    Отже, віднімемо від усіх елементів першого стовпця 0, а від усіх елементів другого – 1.
    Одержимо таку матрицю жалю:
    $$S=\begin{pmatrix}0&3\\5&0\\6&2\\3&1\end{pmatrix}.$$
    У цій матриці знайдемо максимальний елемент у кожному рядку:
    $$S(\alpha_1)=3,$$ 
    $$S(\alpha_2)=5,$$
    $$S(\alpha_3)=6,$$
    $$S(\alpha_4)=3.$$
    У цьому випадку матимемо дві стратегії, що відповідають
    оптимальному нерандомізованому розв’язку, – першу та четверту. Тобто,
    $$\alpha^*=\alpha_1\ \ або\ \ \alpha^*=\alpha_4,\ S^*=3.$$
 


    <h2>1.2. Рандомізований розв’язок. Геометрична інтерпретація.</h2>

    Очевидно, що перехід від матриці втрат до матриці жалю геометрично відповідає паралельному перенесенню осей
    координат до їх дотику із платіжною множиною \(K\).
    Точки самої платіжної множини \(K\) змінять свої координати.
    Застосуємо мінімаксний критерій до платіжної множини із новими координатами, тобто знайдемо першу точку перетину
    нової платіжної множини із прямокутним клином.


    <h3>Алгоритм пошуку рандомізованого розв’язку</h3>
    <ol>
        <li>Побудувати платіжну множину \(K\) за матрицею втрат.</li>
        <li>Перенести осі координат до їх першого дотику до платіжної множини \(K\). Одержимо систему координат
            \(S_1O'S_2\).</li>
        <li>Перерахувати координати точок платіжної множини \(K\) відповідно до нової системи координат.</li>
        <li>Побудувати прямокутний клин у новій системі координат та рухати його по прямій \(S_1=S_2\) до першого
            перетину із платіжною множиною.
            Визначити точки \(\alpha_i\ \ \ (s_{i1};s_{i2})\) та \(\alpha_j\ \ \ (s_{j1};s_{j2})\), що задають
            відрізок платіжної множини, з яким перетнувся клин.</li>
        <li>Записати опуклу комбінацію кінців відрізка, а саме:
            $$x_i\begin{pmatrix}s_{i1}\\s_{i2}\end{pmatrix} +
            x_j\begin{pmatrix}s_{j1}\\s_{j2}\end{pmatrix}=\begin{pmatrix}S_1\\S_2\end{pmatrix}$$
            або враховуючи, що \(x_i+x_j=1\):
            $$x\begin{pmatrix}s_{i1}\\s_{i2}\end{pmatrix} +
            (1-x)\begin{pmatrix}s_{j1}\\s_{j2}\end{pmatrix}=\begin{pmatrix}S_1\\S_2\end{pmatrix}.$$
        </li>
        <li>Оскільки \(S_1=S_2\), побудувати рівняння
            $$x\cdot s_{i1}+(1-x)\cdot s_{j1}=x\cdot s_{i2}+(1-x)\cdot s_{j2}.$$
            Розв’язавши це рівняння, знайти \(x\).</li>
        <li>Рандомізований розв’язок буде такий:
            $$(0;\dots;0;\underbrace{x}_\text{index i};0;\dots;0;\underbrace{1-x}_\text{index j};0;\dots;0).$$
        </li>
    </ol>
    <b>Приклад 1.2</b><br>

    Матриця втрат має вигляд
    $$L=\begin{pmatrix}0&4\\5&1\\6&3\\3&2\end{pmatrix}.$$
    Геометрична інтерпретація наведена рис. 1.1 (у дужках подані нові ординати точок, абсциси точок не змінені).
    Зауважимо: оскільки точка \(\alpha_1\) лежить на осі координат \(L_2\), то вісь \(L_2\) збігатиметься із віссю
    \(S_2\).

    <center><img src="images/Image 1.1.PNG"></center>
    <center><b>Рис. 1.1. Приклад геометричної інтерпретації критерію Севіджа.</b></center>


    Із рис. 1.1 видно, що прямокутний клин перетинається із відрізком, що з’єднує точки \(\alpha_1\ (0;3)\) та
    \(\alpha_4\ (3;1)\).<br>
    Знайдемо координати точки перетину:
    $$x\begin{pmatrix}0\\3\end{pmatrix}+(1-x)\begin{pmatrix}3\\1\end{pmatrix}=\begin{pmatrix}S_1\\S_2\end{pmatrix}$$
    (зауважимо, що в цьому випадку \(x\) – імовірність розв’язку \(\alpha_1\), а \((1-x)\) – розв’язку
    \(\alpha_4\)),<br>
    $$x\cdot 0+(1-x)\cdot 3=x\cdot 3+(1-x)\cdot 1,$$
    $$3-3x=3x+1-x,$$
    $$5x=2,$$
    $$x= \frac{5}{2}.$$
    Тобто рандомізований розв’язок за цим критерієм буде \((\frac{2}{5};0;0;\frac{3}{5})\). Отже, у двох випадках ми
    діємо за першим варіантом і в трьох – за четвертим.

    <h1>2. Критерій оптимальності Неймана-Пірсона</h1>
    Критерій оптимальності Неймана-Пірсона застосовується тоді, коли природа може знаходитися у двох станах, один із
    яких можна контролювати, а інший – ні.
    Для стану, який ми можемо контролювати, вводиться граничне значення \(L_{пор}\) і всі допустимі розв’язки, які для
    цього стану призводять до втрат, більших за граничне значення, виключаються з розгляду.
    Згідно з критерієм Неймана-Пірсона із двох розв’язків кращим є той, для якого втрати для стану, що не
    контролюється, менші.
    <h2>2.1. Нерандомізований розв'язок.</h2>


    <h3>Алгоритм пошуку нерандомізованого розв’язку</h3>
    <ol>
        <li>Виключити із розгляду всі стратегії, яким у контрольованому стані природи відповідають втрати, більші за допустиме граничне значення.</li>
        <li>Обрати як розв’язок таку стратегію \(\alpha_i\), якій відповідають найменші втрати для стану, що не контролюється.</li>
    </ol>

    <b>Приклад 2.1</b><br>
    Матриця втрат має вигляд
    $$L=\begin{pmatrix}0&4\\5&1\\6&3\\3&2\end{pmatrix}.$$
    Нехай ми контролюємо другий стан і для нього граничне значення \(L_{пор}=3\). Тоді матриця скоротиться на один рядок:
    $$L'=\begin{pmatrix}&\\5&1\\6&3\\3&2\end{pmatrix}.$$
    Розглянемо стан, що не контролюється (перший). Для нього найменше значення – 3. Тобто оптимальний нерандомізований
    розв’язок – це четверта стратегія:

    $$\alpha^*=\alpha_4,\ L^* = 3.$$

    <h2>2.2. Рандомізований розв’язок. Геометрична інтерпретація.</h2>
    У геометричній інтерпретації із платіжної множини виключаються всі розв’язки для яких значення за станом, що
    контролюється, більші за граничне значення. З усіх інших точок множини вибирають ту, для якої значення за станом, що не контролюється, найменше.


    <h3>Алгоритм пошуку рандомізованого розв’язку</h3>
    <ol>
        <li>Побудувати платіжну множину за матрицею втрат.</li>
        <li>Виключити із платіжної множини всі точки, для яких значення за станом, що контролюється (значення
            відповідної координати), більше за граничне.</li>
        <li>Знайти координати точки платіжної множини, якій відповідає найменше значення за станом, що не контролюється.
            Зазвичай його можна знайти із рівняння \(x_i\begin{pmatrix}l_{i1}\\l_{i2}\end{pmatrix} +
            (1-x_i)\begin{pmatrix}l_{j1}\\l_{j2}\end{pmatrix}=\begin{pmatrix}L_1\\L_2\end{pmatrix}\), де \(L_i\)
            відповідає граничному значенню стану, що контролюється, і таким чином можна знайти розв’язок.</li>
    </ol>

    Можливі 3 випадки:
    <ol>
        <li>Розв'язок на відрізку.</li>
        <center><img src="images/Image 2.1.PNG"></center>
        <center><b>Рис. 2.1. Розв'язок лежить на відрізку.</b></center>
        <li>Розв'язок у точці.</li>
        <center><img src="images/Image 2.2.PNG"></center>
        <center><b>Рис. 2.2. Розв'язок лежить у точці.</b></center>
        <li>Розв'язку немає.</li>
        <center><img src="images/Image 2.3.PNG"></center>
        <center><b>Рис. 2.3. Розв'язку немає.</b></center>
    </ol>


    
    <b>Приклад 2.2</b><br>
    Матриця втрат має вигляд
    $$L=\begin{pmatrix}0&4\\5&1\\6&3\\3&2\end{pmatrix}.$$
    Нехай стан, що контролюється, другий, а граничне значення для нього \(L_{пор}=3\).
    <center><img src="images/Image 2.4.PNG"></center>
    <center><b>Рис. 2.4. Приклад геометричної інтерпретації критерію.</b></center>
    Геометрична інтерпретація зображена на рис. 2.1.
    Після виключення з платіжної множини точок, значення в яких більше за граничне, одержимо множину, обмежену точками
    \(\alpha_4,\alpha_2,\alpha_3,\alpha^*\).
    Найменшому значенню за станом, що не контролюється, відповідає точка \(\alpha^*\).
    Знайдемо її координати з рівняння $$x\begin{pmatrix}0\\4\end{pmatrix} +
    (1-x)\begin{pmatrix}3\\2\end{pmatrix}=\begin{pmatrix}L_1\\3\end{pmatrix}.$$
    Матимемо
    $$x\cdot 4+(1-x)\cdot 2=3.$$
    Звідси \(x=\frac{1}{2}\) – це імовірність розв’язку \(\alpha_1\), відповідно \(1-x=\frac{1}{2}\) – імовірність розв’язку
    \(\alpha_4\).
    Тобто рандомізований розв’язок матиме вигляд \((\frac{1}{2};0;0;\frac{1}{2})\).
    <h2><a style="text-decoration: none;" href="quiz.html">Перейти до тестiв</a></h2>
  
</body>
</html>